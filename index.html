<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=1">
<link rel="icon" type="image/png" href="img/jabjab logo.png">
<title>JäbJäb Auswahl</title>

<style>
/* GLOBAL */
* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
html, body { margin: 0; padding: 0; height: 100%; }

body {
    font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", Arial;
    margin: 0;
    overflow-x: hidden;

    padding-bottom: 220px;

    background: radial-gradient(circle at 20% 20%, rgba(255, 130, 210, 0.55), transparent 50%),
                radial-gradient(circle at 80% 30%, rgba(120, 180, 255, 0.50), transparent 55%),
                radial-gradient(circle at 50% 80%, rgba(255, 220, 140, 0.45), transparent 50%),
                linear-gradient(135deg, #5A8CFF 0%, #974BFF 50%, #FF63C3 100%);

    background-blend-mode: screen, overlay, normal, normal;
    background-attachment: fixed;
    filter: brightness(1.1) saturate(1.25);
}

/* HEADER */
.header {
    text-align: center;
    padding: 40px 20px 10px;
    color: #000;
}

.logo {
    width: clamp(120px, 22vw, 200px);
    height: auto;
    margin: 0 auto 20px;
    display: block;
}

/* Title */
.title {
    font-size: clamp(30px, 6vw, 48px);
    font-weight: 800;
}

.subtitle {
    font-size: clamp(20px, 4vw, 30px);
    font-weight: 700;
}

/* ROWS */
.row-wrapper {
    margin: 35px 22px;
    border-radius: 24px;
    padding: 20px;
    transition: 0.25s ease;
}

.row-images {
    display: grid;
    grid-template-columns: repeat(4, 1fr) !important;
    gap: 12px;
}

.row-label {
    text-align: center;
    font-size: clamp(20px, 4vw, 34px);
    font-weight: 900;
    margin-bottom: 14px;
    color: rgba(255,255,255,0.95);
    text-shadow: 0 0 8px rgba(0,0,0,0.6);
}

/* IMAGE STYLE */
.row-images img {
    width: 100%;
    border-radius: 18px;
    display: block;
    object-fit: cover;
}

/* SELECTED ROW */
.row-wrapper.selected {
    outline: 6px solid #fff;
    box-shadow:
        0 0 25px rgba(255,255,255,0.9),
        0 0 45px rgba(255,120,255,0.7),
        0 0 70px rgba(120,180,255,0.5);
    transform: scale(1.03);
}

/* FOOTER */
.footer {
    position: sticky;
    bottom: 0;
    width: 100%;
    height: 85px;

    backdrop-filter: blur(20px);
    background: rgba(255,255,255,0.7);

    padding: 12px 26px calc(env(safe-area-inset-bottom) + 10px);

    display: flex;
    justify-content: space-between;
    align-items: center;

    font-weight: 700;
    font-size: clamp(16px, 2.5vw, 22px);
    color: #000;
    z-index: 1000;
}

#weiterBtn {
    padding: 10px 26px;
    border: none;
    border-radius: 16px;
    background: #d3d3d3;
    color: #666;
    font-size: clamp(15px, 2vw, 18px);
    transition: 0.25s ease;
}

#weiterBtn.active {
    background: #00D26A;
    color: white;
    box-shadow: 0 4px 20px rgba(0,200,110,0.4);
    cursor: pointer;
}
@media (min-width: 1025px) {
    .row-wrapper {
        margin-left: 60px !important;
        margin-right: 60px !important;
    }
}


</style>
</head>

<body>

<!-- HEADER -->
<div class="header">
    <img src="img/jabjab logo.png" class="logo">
    <div class="title">Deine Wahl, Dein Stil</div>
    <div class="subtitle">Wähle 3 Lieblingsbälle</div>
    <div class="subtitle" style="font-size: 22px;">Klicke auf die 3 Bälle</div>
</div>

<!-- GRID -->
<div id="rowsContainer"></div>

<!-- FOOTER -->
<div class="footer">
    <div><span id="count">0</span> / 3 ausgewählt</div>
    <button id="weiterBtn">Weiter</button>
</div>

<script>
/* GOOGLE FORM */
const formURL =
 "https://docs.google.com/forms/d/1fRd6PAI_IcwVgsTk2PZ0iH5CYzMiSQ6bqm7Rlod4rSU/formResponse";
const entryID = "entry.875728941";

/* GRADIENT COLORS */
const gradients = [
    "linear-gradient(135deg, #2ad8d0 0%, #7a3cff 45%, #ff2ad6 100%)",
    "linear-gradient(135deg, #00d4ff 0%, #0090ff 40%, #0058ff 100%)",
    "linear-gradient(135deg, #3a0ca3 0%, #7209b7 35%, #ff6a00 100%)",
    "linear-gradient(135deg, #ff0033 0%, #ff4a4a 33%, #45ff55 100%)",
    "linear-gradient(135deg, #6d28d9 0%, #b26efc 40%, #ff8fa3 100%)",
    "linear-gradient(135deg, #ffe066 0%, #ffb347 35%, #ff6fb7 100%)",
    "linear-gradient(135deg, #35f2e3 0%, #42a5ff 40%, #ff70d9 100%)",
    "linear-gradient(135deg, #ffe259 0%, #ff9d00 40%, #ff6a00 100%)"
];

let selectedRows = [];
const container = document.getElementById("rowsContainer");

/* BUILD ROWS */
const colorNames = [
    "Türkis & Magenta", "Türkis & Blau", "Indigo & Blutorange", "Rot & Grün",
    "Violett & Salmon", "Gelb & Rosa", "Türkis & Rosa", "Orange & Gelb"
];

for (let i = 0; i < 8; i++) {
    const wrapper = document.createElement("div");
    wrapper.className = "row-wrapper";
    wrapper.style.background = gradients[i];
    wrapper.dataset.row = "Ball" + (i + 1);

    const label = document.createElement("div");
    label.className = "row-label";
    label.textContent = colorNames[i];
    wrapper.appendChild(label);

    const imgs = document.createElement("div");
    imgs.className = "row-images";

    ["front", "back", "left", "right"].forEach(a => {
        const img = document.createElement("img");
        img.src = `img/ball${i + 1}-${a}.jpg`;
        imgs.appendChild(img);
    });

    wrapper.appendChild(imgs);

    wrapper.addEventListener("click", () => {
        const val = wrapper.dataset.row;

        if (wrapper.classList.contains("selected")) {
            wrapper.classList.remove("selected");
            selectedRows = selectedRows.filter(x => x !== val);
        } else if (selectedRows.length < 3) {
            wrapper.classList.add("selected");
            selectedRows.push(val);
        }

        updateUI();
    });

    container.appendChild(wrapper);
}

function updateUI() {
    document.getElementById("count").innerText = selectedRows.length;
    const btn = document.getElementById("weiterBtn");

    if (selectedRows.length === 3) btn.classList.add("active");
    else btn.classList.remove("active");
}

/* THANK-YOU SCREEN + CONFETTI */
document.getElementById("weiterBtn").addEventListener("click", () => {
    if (selectedRows.length !== 3) return;

    const fd = new FormData();
    fd.append(entryID, selectedRows.join(", "));
    fetch(formURL, { method: "POST", mode: "no-cors", body: fd });

    // Replace full screen
    document.body.innerHTML = `
        <style>
            @keyframes pulse {
                0% { transform: scale(1); }
                50% { transform: scale(1.18); }
                100% { transform: scale(1); }
            }
        </style>

        <div style="
            position:fixed; inset:0; display:flex; flex-direction:column;
            justify-content:center; align-items:center;
            background: linear-gradient(135deg, #5AB0FF, #D168FF);
            font-family:-apple-system, BlinkMacSystemFont, Arial;
            text-align:center;">
            
            <img src="img/jabjab logo.png" style="width:260px; margin-bottom:35px;">
            
            <div style="
                font-size:110px;
                font-weight:900;
                animation:pulse 1.4s ease-in-out infinite;">
                Danke! ✔
            </div>

            <div style="font-size:45px; margin-top:22px; font-weight:700;">
                Neuer Kunde in 3 Sekunden…
            </div>
        </div>
    `;

    /* Load confetti library AFTER replacing body */
    let script = document.createElement("script");
    script.src = "https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js";
    script.onload = () => {
        setTimeout(() => startConfetti(), 100);
    };
    document.body.appendChild(script);

    /* Reload after 3 sec */
    setTimeout(() => location.reload(), 3000);
});

/* CONFETTI FUNCTION */
function startConfetti() {
    confetti({
        particleCount: 120,
        spread: 90,
        origin: { y: 0.6 }
    });

    setTimeout(() => {
        confetti({
            particleCount: 180,
            spread: 120,
            origin: { y: 0.3 }
        });
    }, 300);

    let duration = 1500;
    let end = Date.now() + duration;

    (function frame() {
        confetti({
            particleCount: 6,
            spread: 70
        });
        if (Date.now() < end) {
            requestAnimationFrame(frame);
        }
    })();
}

</script>

</body>
</html>
